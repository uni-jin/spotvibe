# 📋 SpotVibe 서비스 방향 전환 및 계획 토론

## 🎯 서비스 방향 전환

### 현재 상황
- 기존: 핫플레이스에 식당, 쇼핑, 팝업스토어 모두 제공
- 변경: **팝업스토어를 메인으로 제공**하되, 다른 카테고리도 함께 지원

### 새로운 접근 방식
1. **팝업스토어 우선**: Hot Spots Now에서 팝업스토어를 메인으로 표시
2. **다른 카테고리 통합**: 식당, 쇼핑 등을 별도 섹션으로 Hot Spots Now에 표시
3. **초기 단계**: 체계가 완벽하지 않더라도 포스팅 시 선택 가능하게 하고 Hot Spots Now에도 노출

---

## 🏷️ 카테고리 구조 제안

### 현재 DB 스키마
현재 `places.type`에는 다음 값들이 정의되어 있음:
- `popup_store` (팝업스토어)
- `cafe` (카페)
- `restaurant` (식당)
- `shop` (쇼핑)
- `other` (기타)

### 제안하는 카테고리 구조

#### 옵션 1: 간단한 3단계 구조 (추천)
```
1. 팝업스토어 (popup_store) - 메인
2. 식당 (restaurant) - 통합 카테고리
3. 쇼핑 (shop) - 통합 카테고리
```

**장점:**
- 단순하고 명확함
- 사용자가 선택하기 쉬움
- 확장 가능 (나중에 세부 카테고리 추가 가능)

**단점:**
- 식당과 쇼핑이 너무 광범위할 수 있음

#### 옵션 2: 세부 카테고리 구조
```
1. 팝업스토어 (popup_store)
   - 패션 팝업
   - 뷰티 팝업
   - 라이프스타일 팝업
   
2. 식당 (restaurant)
   - 카페
   - 레스토랑
   - 디저트
   - 바/펍
   
3. 쇼핑 (shop)
   - 패션/의류
   - 뷰티/화장품
   - 라이프스타일
   - 액세서리
```

**장점:**
- 더 세밀한 분류
- 검색/필터링에 유리
- 확장성 좋음

**단점:**
- 초기 구현 복잡도 증가
- 사용자 선택 부담 증가

### 🎯 추천안: 하이브리드 접근

**Phase 1 (현재):**
- 메인 카테고리: `popup_store`, `restaurant`, `shop`
- 세부 카테고리는 나중에 추가

**Phase 2 (확장):**
- 각 메인 카테고리에 세부 카테고리 추가
- `places` 테이블에 `sub_category` 필드 추가

**구현 제안:**
```sql
-- Phase 1: 현재 구조 유지
type: 'popup_store' | 'restaurant' | 'shop'

-- Phase 2: 세부 카테고리 추가
ALTER TABLE places ADD COLUMN sub_category TEXT;
-- 예: type='restaurant', sub_category='cafe'
-- 예: type='shop', sub_category='fashion'
```

---

## 🏗️ 관리자 사이트 계획

### 보안 요구사항
1. **별도 URL**: `/admin` 또는 서브도메인 (`admin.spotvibe.com`)
2. **관리자 계정 시스템**:
   - Supabase Auth 사용
   - `profiles` 테이블에 `is_admin` 필드 추가
   - RLS 정책으로 관리자만 접근 가능
3. **인증 방식**:
   - Google OAuth (기존과 동일)
   - 관리자 승인된 계정만 접근

### 관리자 사이트 기능

#### Phase 1: 팝업스토어 등록 (우선)
**등록 항목:**
- 카테고리 (type): `popup_store` (초기에는 고정)
- 장소명 (name): 한글명
- 영문명 (name_en): 영문명 (선택)
- 대표사진 (thumbnail_url): 대표 이미지 URL
- 위치 (lat, lng): GPS 좌표 (지도에서 선택 또는 직접 입력)
- 설명 (description): 장소 설명 (선택)
- 상태 (status): Very Busy, Busy, No Wait 등 (선택, 기본값: '🟢 Quiet')
- 대기 시간 (wait_time): 대기 시간 정보 (선택)
- 활성화 여부 (is_active): 표시 여부

**UI 구성:**
- 장소 목록 (테이블 또는 카드 형태)
- 등록/수정 폼
- 지도에서 위치 선택 (Leaflet 사용)
- 이미지 업로드 (Supabase Storage)

#### Phase 2: 다른 카테고리 등록
- 식당, 쇼핑 등록 기능 추가
- 카테고리별 필터링

---

## 📍 포스팅 시 장소 선택 UX

### 현재 방식
- 드롭다운에서 장소 선택 또는 "기타" 직접 입력

### 제안하는 방식

#### 옵션 1: 2단계 선택 (카테고리 → 장소명)
```
1단계: 카테고리 선택
  [팝업스토어] [식당] [쇼핑] [기타]

2단계: 장소명 선택 (선택한 카테고리에 따라 필터링)
  드롭다운: [관리자 등록 장소 목록] + "기타" 옵션
```

**장점:**
- 카테고리별로 명확하게 구분
- 관리자 등록 장소와 사용자 입력 구분 용이
- 나중에 통계/분석에 유리

**단점:**
- 2단계 선택으로 UX가 약간 복잡해질 수 있음
- 초기에는 카테고리 선택이 불필요할 수 있음

#### 옵션 2: 통합 드롭다운 (카테고리 + 장소명)
```
드롭다운:
  [팝업스토어] 디올 성수
  [팝업스토어] 아더 성수
  [식당] 성수동 카페거리
  [쇼핑] ...
  ─────────────
  [기타] 직접 입력
```

**장점:**
- 1단계 선택으로 간단함
- 카테고리 정보도 함께 표시
- 사용자 경험 부담 적음

**단점:**
- 드롭다운이 길어질 수 있음
- 카테고리별 그룹화가 덜 명확

#### 옵션 3: 하이브리드 (추천)
```
1. 카테고리 선택 (탭 또는 버튼)
   [팝업스토어] [식당] [쇼핑] [기타]

2. 선택한 카테고리에 따라 드롭다운 필터링
   - 팝업스토어 선택 시: 팝업스토어 목록만 표시
   - "기타" 선택 시: 직접 입력 필드 표시
```

**장점:**
- 직관적이고 명확함
- 카테고리별 필터링으로 선택 부담 감소
- 확장성 좋음

**단점:**
- 초기 구현이 약간 복잡할 수 있음

### 🎯 추천안: 옵션 3 (하이브리드)

**구현 방식:**
1. 카테고리 선택 UI (탭 형태)
2. 선택한 카테고리에 따라 드롭다운 필터링
3. "기타" 선택 시 직접 입력 필드 표시
4. 거리 정보 표시 (GPS 위치가 있을 때)

---

## 🗺️ 지도 기능 개선

### 현재 기능
- 포스팅 위치를 마커로 표시
- 클러스터링 지원

### 추가할 기능

#### 1. 카테고리별 필터링
- 지도 상단에 카테고리 필터 버튼
- 선택한 카테고리만 표시
- 여러 카테고리 동시 선택 가능

#### 2. 카테고리별 차별화된 핀
- 팝업스토어: 🏪 아이콘 (또는 커스텀 핀)
- 식당: 🍽️ 아이콘
- 쇼핑: 🛍️ 아이콘
- 색상으로도 구분 가능

#### 3. 관리자 등록 정보와 사용자 포스팅 통합 표시
- 관리자 등록 장소: 별도 마커 (예: 별 모양)
- 사용자 포스팅: 썸네일 마커 (현재 방식)
- 클릭 시:
  - 관리자 등록 장소: 장소 정보 + 해당 장소 포스팅 목록
  - 사용자 포스팅: 포스팅 상세 정보

#### 4. 지도 레이어 구조
```
Layer 1: 관리자 등록 장소 (고정 마커)
Layer 2: 사용자 포스팅 (클러스터링 가능)
```

---

## 📊 데이터베이스 스키마 변경 필요사항

### places 테이블 추가 필드
```sql
ALTER TABLE places ADD COLUMN IF NOT EXISTS thumbnail_url TEXT;
ALTER TABLE places ADD COLUMN IF NOT EXISTS description TEXT;
```

### profiles 테이블 관리자 필드
```sql
ALTER TABLE profiles ADD COLUMN IF NOT EXISTS is_admin BOOLEAN DEFAULT false;
```

### RLS 정책 추가
```sql
-- 관리자만 places 테이블 수정 가능
CREATE POLICY "Only admins can modify places" ON places
  FOR ALL USING (
    EXISTS (
      SELECT 1 FROM profiles
      WHERE profiles.id = auth.uid()::text
      AND profiles.is_admin = true
    )
  );
```

---

## 🎨 UI/UX 고려사항

### Hot Spots Now 섹션
- **팝업스토어 섹션**: 메인으로 강조 표시
- **다른 카테고리 섹션**: "식당 & 쇼핑" 같은 통합 섹션으로 표시
- 카테고리별 탭 또는 구분선으로 분리

### 포스팅 모달
- 카테고리 선택 UI (탭 또는 버튼)
- 선택한 카테고리에 따라 장소 드롭다운 필터링
- 거리 정보 표시 (GPS 위치가 있을 때)

### 지도 화면
- 카테고리 필터 버튼 (상단 또는 사이드바)
- 카테고리별 색상/아이콘 구분
- 관리자 등록 장소와 사용자 포스팅 구분

---

## ✅ 다음 단계 결정 사항

### 1. 카테고리 구조
- [ ] 옵션 1 (간단한 3단계) 선택
- [ ] 옵션 2 (세부 카테고리) 선택
- [ ] 하이브리드 접근 선택

### 2. 포스팅 시 장소 선택 방식
- [ ] 옵션 1 (2단계 선택) 선택
- [ ] 옵션 2 (통합 드롭다운) 선택
- [ ] 옵션 3 (하이브리드) 선택

### 3. 관리자 사이트 URL
- [ ] `/admin` 경로 사용
- [ ] 서브도메인 사용 (`admin.spotvibe.com`)

### 4. 우선순위
- [ ] 관리자 사이트 먼저 (팝업스토어 등록)
- [ ] 카테고리 구조 정리 먼저
- [ ] 포스팅 UX 개선 먼저

---

## 💡 추가 조언

### 카테고리 개수
**추천: 3-5개가 적당**
- 너무 적으면 (2개): 구분이 모호함
- 너무 많으면 (10개+): 선택 부담 증가
- 3-5개가 사용자 경험과 확장성의 균형점

### 초기 단계 접근
1. **간단하게 시작**: 3개 카테고리 (팝업스토어, 식당, 쇼핑)
2. **데이터 수집**: 사용자 사용 패턴 관찰
3. **점진적 확장**: 필요에 따라 세부 카테고리 추가

### 관리자 사이트 보안
1. **RLS 정책**: Supabase RLS로 데이터베이스 레벨 보안
2. **클라이언트 검증**: UI에서 관리자 체크
3. **서버 검증**: API 레벨에서도 관리자 체크 (필요 시)
4. **로그 기록**: 관리자 작업 로그 기록 (나중에 추가)

---

## 📝 작업 순서 제안

1. **카테고리 구조 결정 및 DB 스키마 정리**
2. **관리자 사이트 구축** (팝업스토어 등록)
3. **포스팅 UX 개선** (카테고리 선택 + 관리자 등록 장소 드롭다운)
4. **Hot Spots Now 개선** (카테고리별 섹션)
5. **지도 기능 개선** (카테고리 필터, 차별화된 핀)
